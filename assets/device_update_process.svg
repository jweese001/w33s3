<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="900" viewBox="0 0 800 900">
  <defs>
    <style>
      .start-end { fill: #90EE90; stroke: #333; stroke-width: 2; }
      .process { fill: #87CEEB; stroke: #333; stroke-width: 2; }
      .decision { fill: #FFB6C1; stroke: #333; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; }
      .small-text { font-family: Arial, sans-serif; font-size: 10px; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; text-anchor: middle; }
      .line { stroke: #333; stroke-width: 2; fill: none; }
      .dashed-line { stroke: #666; stroke-width: 2; fill: none; stroke-dasharray: 5,5; opacity: 0.7; }
      .decision-text { font-family: Arial, sans-serif; font-size: 11px; text-anchor: middle; }
      .label-text { font-family: Arial, sans-serif; font-size: 10px; text-anchor: middle; fill: #666; }
      .arrow { fill: #333; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" class="title">Device Startup and Update Process</text>
  
  <!-- Start -->
  <ellipse cx="400" cy="80" rx="80" ry="30" class="start-end"/>
  <text x="400" y="85" class="text">Device Powers On</text>
  
  <!-- Main Flow Column -->
  <!-- WX Updater Launch -->
  <rect x="320" y="140" width="160" height="50" class="process"/>
  <text x="400" y="160" class="text">WX Updater Launches</text>
  <text x="400" y="175" class="text">After Android Boot</text>
  
  <!-- Check Connectivity -->
  <rect x="320" y="220" width="160" height="50" class="process"/>
  <text x="400" y="240" class="text">Check Connectivity to</text>
  <text x="400" y="255" class="text">WX Backend Server</text>
  
  <!-- Check for Updates -->
  <rect x="320" y="300" width="160" height="50" class="process"/>
  <text x="400" y="320" class="text">Check for Updates to</text>
  <text x="400" y="335" class="text">WX Utility Service</text>
  
  <!-- Launch Health Matters -->
  <rect x="320" y="380" width="160" height="50" class="process"/>
  <text x="400" y="400" class="text">Launch Health Matters</text>
  <text x="400" y="415" class="text">Primary Application</text>
  
  <!-- Send Tracking Data -->
  <rect x="320" y="460" width="160" height="50" class="process"/>
  <text x="400" y="480" class="text">Send Device Tracking</text>
  <text x="400" y="495" class="text">Data to Server</text>
  
  <!-- Close Updater -->
  <rect x="320" y="540" width="160" height="50" class="process"/>
  <text x="400" y="565" class="text">Close After Startup Tasks</text>
  
  <!-- Background Service Branch -->
  <!-- WX Utility Background Service -->
  <rect x="50" y="640" width="200" height="80" class="process"/>
  <text x="150" y="665" class="text">WX Utility Background Service:</text>
  <text x="150" y="680" class="small-text">• Set filesystem permissions</text>
  <text x="150" y="695" class="small-text">• Verify timezone</text>
  <text x="150" y="710" class="small-text">• Clear app caches</text>
  
  <!-- Update Check Decision -->
  <polygon points="400,630 480,660 400,690 320,660" class="decision"/>
  <text x="400" y="655" class="decision-text">Updates</text>
  <text x="400" y="670" class="decision-text">Available?</text>
  
  <!-- Download Updates -->
  <rect x="550" y="630" width="140" height="60" class="process"/>
  <text x="620" y="655" class="text">Download Updates</text>
  <text x="620" y="670" class="text">in Background</text>
  
  <!-- Reboot Decision -->
  <polygon points="400,750 480,780 400,810 320,780" class="decision"/>
  <text x="400" y="775" class="decision-text">Scheduled</text>
  <text x="400" y="790" class="decision-text">Reboot?</text>
  
  <!-- Install Updates and Reboot -->
  <rect x="550" y="740" width="140" height="80" class="process"/>
  <text x="620" y="765" class="text">Install Updates</text>
  <text x="620" y="780" class="text">Send Tracking Data</text>
  <text x="620" y="795" class="text">Reboot Device</text>
  
  <!-- Connection Lines -->
  <!-- Main Flow -->
  <line x1="400" y1="110" x2="400" y2="140" class="line"/>
  <polygon points="395,135 400,140 405,135" class="arrow"/>
  
  <line x1="400" y1="190" x2="400" y2="220" class="line"/>
  <polygon points="395,215 400,220 405,215" class="arrow"/>
  
  <line x1="400" y1="270" x2="400" y2="300" class="line"/>
  <polygon points="395,295 400,300 405,295" class="arrow"/>
  
  <line x1="400" y1="350" x2="400" y2="380" class="line"/>
  <polygon points="395,375 400,380 405,375" class="arrow"/>
  
  <line x1="400" y1="430" x2="400" y2="460" class="line"/>
  <polygon points="395,455 400,460 405,455" class="arrow"/>
  
  <line x1="400" y1="510" x2="400" y2="540" class="line"/>
  <polygon points="395,535 400,540 405,535" class="arrow"/>
  
  <!-- Split to Utility Service and Decision -->
  <line x1="400" y1="590" x2="400" y2="610" class="line"/>
  <polygon points="395,605 400,610 405,605" class="arrow"/>
  
  <!-- To Utility Service -->
  <line x1="400" y1="610" x2="150" y2="610" class="line"/>
  <line x1="150" y1="610" x2="150" y2="640" class="line"/>
  <polygon points="145,635 150,640 155,635" class="arrow"/>
  
  <!-- To Decision -->
  <line x1="400" y1="610" x2="400" y2="630" class="line"/>
  <polygon points="395,625 400,630 405,625" class="arrow"/>
  
  <!-- Update Check Decision - Yes path -->
  <line x1="480" y1="660" x2="520" y2="660" class="line"/>
  <line x1="520" y1="660" x2="520" y2="650" class="line"/>
  <line x1="520" y1="650" x2="550" y2="650" class="line"/>
  <polygon points="545,645 550,650 545,655" class="arrow"/>
  <text x="515" y="645" class="label-text">Yes</text>
  
  <!-- Update Check Decision - No path -->
  <line x1="320" y1="660" x2="280" y2="660" class="line"/>
  <line x1="280" y1="660" x2="280" y2="720" class="line"/>
  <line x1="280" y1="720" x2="280" y2="780" class="line"/>
  <line x1="280" y1="780" x2="320" y2="780" class="line"/>
  <polygon points="315,775 320,780 315,785" class="arrow"/>
  <text x="300" y="645" class="label-text">No</text>
  
  <!-- From downloads to reboot decision -->
  <line x1="620" y1="690" x2="620" y2="720" class="line"/>
  <line x1="620" y1="720" x2="450" y2="720" class="line"/>
  <line x1="450" y1="720" x2="450" y2="740" class="line"/>
  <line x1="450" y1="740" x2="400" y2="740" class="line"/>
  <line x1="400" y1="740" x2="400" y2="750" class="line"/>
  <polygon points="395,745 400,750 405,745" class="arrow"/>
  
  <!-- Reboot Decision - Yes path -->
  <line x1="480" y1="780" x2="520" y2="780" class="line"/>
  <line x1="520" y1="780" x2="520" y2="770" class="line"/>
  <line x1="520" y1="770" x2="550" y2="770" class="line"/>
  <polygon points="545,765 550,770 545,775" class="arrow"/>
  <text x="515" y="765" class="label-text">Yes</text>
  
  <!-- Reboot Decision - No path (continue monitoring) -->
  <line x1="320" y1="780" x2="280" y2="780" class="line"/>
  <line x1="280" y1="780" x2="280" y2="720" class="line"/>
  <line x1="280" y1="720" x2="250" y2="720" class="line"/>
  <line x1="250" y1="720" x2="250" y2="700" class="line"/>
  <line x1="250" y1="700" x2="50" y2="700" class="line"/>
  <polygon points="55,695 50,700 55,705" class="arrow"/>
  <text x="300" y="765" class="label-text">No</text>
  
  <!-- From Utility Service back to Update Check (monitoring loop) -->
  <line x1="150" y1="720" x2="150" y2="760" class="line"/>
  <line x1="150" y1="760" x2="280" y2="760" class="line"/>
  <polygon points="275,755 280,760 275,765" class="arrow"/>
  
  <!-- Loop back to start after reboot -->
  <line x1="620" y1="820" x2="620" y2="860" class="line"/>
  <line x1="620" y1="860" x2="750" y2="860" class="line"/>
  <line x1="750" y1="860" x2="750" y2="80" class="line"/>
  <line x1="750" y1="80" x2="480" y2="80" class="line"/>
  <polygon points="485,75 480,80 485,85" class="arrow"/>
  
  <!-- Utility Service checks for updates (feedback to decision) -->
  <line x1="250" y1="680" x2="300" y2="680" class="dashed-line"/>
  <line x1="300" y1="680" x2="300" y2="660" class="dashed-line"/>
  <line x1="300" y1="660" x2="320" y2="660" class="dashed-line"/>
  <polygon points="315,655 320,660 315,665" fill="#666" opacity="0.7"/>
</svg>